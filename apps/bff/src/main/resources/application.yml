spring:
  application:
    name: bff

  security:
    oauth2:
      client:
        registration:
          hsid:
            provider: hsid
            client-id: ${HSID_CLIENT_ID}
            client-secret: ${HSID_CLIENT_SECRET}
            authorization-grant-type: authorization_code
            redirect-uri: "{baseUrl}/"
            scope: openid,profile,email
          hcp:
            provider: hcp
            client-id: ${HCP_CLIENT_ID}
            client-secret: ${HCP_CLIENT_SECRET}
            authorization-grant-type: client_credentials
          ecdh:
            provider: hcp
            client-id: ${ECDH_CLIENT_ID}
            client-secret: ${ECDH_CLIENT_SECRET}
            authorization-grant-type: client_credentials
        provider:
          hsid:
            issuer-uri: https://nonprod.identity.healthsafe-id.com
            authorization-uri: https://nonprod.identity.healthsafe-id.com/oidc/authorize
            token-uri: https://nonprod.identity.healthsafe-id.com/oidc/token
            jwk-set-uri: https://nonprod.identity.healthsafe-id.com/oidc/jwks
            user-info-uri: https://nonprod.identity.healthsafe-id.com/oidc/userinfo
          hcp:
            token-uri: ${HCP_TOKEN_URI:https://hcp.com/oauth2/token}

  data:
    redis:
      host: ${REDIS_HOST:localhost}
      port: ${REDIS_PORT:6379}
    mongodb:
      uri: ${MONGODB_URI:mongodb://localhost:27017/bff}

# BFF-specific configuration
bff:
  session:
    store: ${BFF_SESSION_STORE:in-memory}
    timeout-minutes: ${BFF_SESSION_TIMEOUT:30}
    cookie-name: BFF_SESSION
    cookie-domain: ${BFF_COOKIE_DOMAIN:abc.com}
    cookie-secure: true
    cookie-http-only: true
    cookie-same-site: Strict
    allowed-origins: ${BFF_ALLOWED_ORIGINS:https://abc.com,https://www.abc.com}
    csrf-cookie-name: ${BFF_CSRF_COOKIE:XSRF-TOKEN}
    csrf-header-name: ${BFF_CSRF_HEADER:X-CSRF-TOKEN}
    session-binding-enabled: ${BFF_SESSION_BINDING:true}
    strict-session-binding: ${BFF_STRICT_BINDING:true}

  cache:
    store: ${BFF_CACHE_STORE:in-memory}
    ttl-minutes: ${BFF_CACHE_TTL:30}

  client:
    user-service:
      base-url: ${USER_SERVICE_URL:https://api.hcp.com/user-service}
    delegate-graph:
      base-url: ${DELEGATE_GRAPH_URL:https://api.hcp.com/delegate/graphql}
    eligibility-graph:
      base-url: ${ELIGIBILITY_GRAPH_URL:https://api.hcp.com/eligibility/graphql}
    ecdh-graph:
      base-url: ${ECDH_GRAPH_URL:https://api.hcp.com/ecdh/graphql}

  eligibility:
    eligible-plan-codes: ${ELIGIBLE_PLAN_CODES:}

  health-cache:
    ttl-hours: ${HEALTH_CACHE_TTL:2}
    background-build-enabled: ${HEALTH_CACHE_BACKGROUND:true}

  document:
    s3-bucket: ${DOCUMENT_S3_BUCKET}
    s3-region: ${AWS_REGION:us-east-1}
    presigned-upload-ttl-minutes: ${DOCUMENT_UPLOAD_TTL:15}
    presigned-download-ttl-minutes: ${DOCUMENT_DOWNLOAD_TTL:5}
    max-file-size-mb: ${DOCUMENT_MAX_SIZE_MB:25}
    max-concurrent-uploads: ${DOCUMENT_MAX_CONCURRENT:4}
    temp-expiry-hours: ${DOCUMENT_TEMP_EXPIRY_HOURS:4}
    kms-key-id: ${DOCUMENT_KMS_KEY_ID:}
    allowed-content-types:
      - application/pdf
      - image/jpeg
      - image/png
      - image/tiff
      - application/vnd.openxmlformats-officedocument.wordprocessingml.document
      - application/vnd.openxmlformats-officedocument.spreadsheetml.sheet

# Actuator endpoints
management:
  endpoints:
    web:
      exposure:
        include: health,info
  endpoint:
    health:
      show-details: when-authorized

# Logging
logging:
  level:
    com.chanakya.bff: ${LOG_LEVEL:INFO}
    org.springframework.security: ${SECURITY_LOG_LEVEL:INFO}
